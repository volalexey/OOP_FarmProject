using FarmProject.Classes;
using System;
using System.Collections.Generic;
using System.Text;

namespace FarmProjectTest
{
    [TestClass]
    public class AnimalPenTests
    {
        [TestMethod]
        public void Constructor_ShouldSetPropertiesAndCalculateMaxCapacity()
        {
            // Arrange
            int size = 10;
            int expectedCapacity = 50;

            // Act
            AnimalPen pen = new AnimalPen(size, 1000, 50);

            // Assert
            Assert.AreEqual(size, pen.Size);
            Assert.AreEqual(expectedCapacity, pen.MaxCapacity);
            Assert.AreEqual(0, pen.AnimalCount);
        }

        [TestMethod]
        public void AddAnimals_ShouldIncreaseCount_WhenBelowCapacity()
        {
            // Arrange
            AnimalPen pen = new AnimalPen(10, 1000, 50);
            int amountToAdd = 20;
            bool expectedResult = true;

            // Act
            bool actualResult = pen.AddAnimals(amountToAdd);

            // Assert
            Assert.AreEqual(expectedResult, actualResult);
            Assert.AreEqual(amountToAdd, pen.AnimalCount);
        }

        [TestMethod]
        public void AddAnimals_ShouldNotExceedCapacity_WhenAddingTooMany()
        {
            // Arrange
            AnimalPen pen = new AnimalPen(10, 1000, 50);
            pen.AddAnimals(40);
            int amountToAdd = 20;
            bool expectedResult = false;
            int expectedCount = 40;

            // Act
            bool actualResult = pen.AddAnimals(amountToAdd);

            // Assert
            Assert.AreEqual(expectedResult, actualResult);
            Assert.AreEqual(expectedCount, pen.AnimalCount);
        }

        [TestMethod]
        public void CalculateIncome_ShouldBeZero_WhenNoAnimals()
        {
            // Arrange
            AnimalPen pen = new AnimalPen(10, 1000, 50);
            pen.AnimalCount = 0;

            // Act
            double income = pen.CalculateIncome();

            // Assert
            Assert.AreEqual(0, income);
        }

        [TestMethod]
        public void CalculateIncome_ShouldUseBaseIncomeAndCount_WhenAnimalsPresent()
        {
            // Arrange
            AnimalPen pen = new AnimalPen(10, 1000, 50);
            pen.AddAnimals(10);
            double expectedIncome = 50 * 10;

            // Act
            double income = pen.CalculateIncome();

            // Assert
            Assert.AreEqual(expectedIncome, income);
        }

        [TestMethod]
        public void CalculateIncome_ShouldBeBoostedByWorkers()
        {
            // Arrange
            AnimalPen pen = new AnimalPen(10, 1000, 50);
            pen.AddAnimals(10);

            Worker worker1 = new Worker("Worker 1", 30, 100) { EfficiencyMultiplier = 1.2 };
            Worker worker2 = new Worker("Worker 2", 30, 100) { EfficiencyMultiplier = 1.3 };
            pen.AssignWorker(worker1);
            pen.AssignWorker(worker2);

            double expectedIncome = 1250;

            // Act
            double income = pen.CalculateIncome();

            // Assert
            Assert.AreEqual(expectedIncome, income);
        }
    }
}
